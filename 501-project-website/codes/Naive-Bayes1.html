<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.649">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Naive Bayes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Naive-Bayes1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Naive-Bayes1_files/libs/quarto-html/quarto.js"></script>
<script src="Naive-Bayes1_files/libs/quarto-html/popper.min.js"></script>
<script src="Naive-Bayes1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Naive-Bayes1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Naive-Bayes1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Naive-Bayes1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Naive-Bayes1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Naive-Bayes1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Naive-Bayes1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>
</style></head><body class="quarto-light" data-new-gr-c-s-check-loaded="14.1088.0" data-gr-ext-installed=""><nav class="navbar navbar-expand-lg navbar-dark bg-pink">
  <div class="container-fluid">
    <a class="navbar-brand" href="https://liumingqian.georgetown.domains/501-project-website/501project-website/index.html">Home</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor02" aria-controls="navbarColor06" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarColor02">
      <ul class="navbar-nav me-auto">
        <li><a class="nav-link" href="../pages/introduction.html">Introduction</a>
        </li>
        <li><a class="nav-link" href="https://github.com/anly501/anly-501-project-YilinYang2000/tree/main/501-project-website/codes">code</a></li>
        <li><a class="nav-link" href="https://github.com/anly501/anly-501-project-YilinYang2000/tree/main/501-project-website/data">data</a></li>
        <li class="nav-item"><a class="nav-link" href="../codes/Data_gathering1.html">Data Gathering</a>
        </li>
        <li><a class="nav-link" href="../codes/data-cleaning1.html">Data Cleaning</a>
        </li>
        <li><a class="nav-link" href="../codes/data-exploring1.html">Exploring Data</a></li>
        <li><a class="nav-link" href="../codes/Naive-Bayes1.html">Naive Bayes</a>
        </li>
        <li class="menu-item-has-children"><a class="nav-link" href="../codes/Decision-Tree1.html">Decision Tree</a>
        </li>
        <li class="menu-item-has-children"><a class="nav-link" href="../codes/SVM.html">SVM</a>
        </li>
        <li><a class="nav-link" href="../codes/Clustering.html">Clustering</a></li>
        <li><a class="nav-link" href="../codes/ARM.html">ARM and Networking</a></li>
        <li><a class="nav-link" href="../codes/Conclusion.html"></a>Conclusions</a></li>
    </ul>
    </div>
  </div>
</nav>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#what-is-naive-bayes" id="toc-what-is-naive-bayes" class="nav-link active" data-scroll-target="#what-is-naive-bayes">What is Naive Bayes?</a></li>
  <li><a href="#naïve-bayes-nb-in-python-with-labeled-text-data" id="toc-naïve-bayes-nb-in-python-with-labeled-text-data" class="nav-link" data-scroll-target="#naïve-bayes-nb-in-python-with-labeled-text-data">Naïve Bayes (NB) in Python with Labeled Text Data</a></li>
  <li><a href="#naive-bayes-in-r" id="toc-naive-bayes-in-r" class="nav-link" data-scroll-target="#naive-bayes-in-r">Naive Bayes in R</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Naive Bayes</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="what-is-naive-bayes" class="level2">
<h2 class="anchored" data-anchor-id="what-is-naive-bayes">What is Naive Bayes?</h2>
<p>Naive Bayes,the original meaning of Naive here is naive, often with a little derogatory taste, and it is used in the name of this algorithm to translate it into simplicity, which can also be called a kind of tolerance. Another keyword, Bayesian, is because the main theoretical basis of the Naive Bayesian algorithm is the Bayesian theorem, so this article first introduces the Bayesian theorem, and then leads to the basic ideas and principles of the Naive Bayesian algorithm</p>
<p>Bayes theorem is generally used to solve the posterior probability, the core formula is:</p>
<p>P(A|B) is called the posterior probability, which is the target to be sought P(A) is the prior probability, which is generally obtained from a large amount of data statistics, and can also be provided based on experience when the amount of data is small P(B|A) is the conditional probability, which can be obtained according to a large amount of data statistics. It is generally given by the method of maximum likelihood estimation, and it actually belongs to the prior probability In fact, P(B) also belongs to the prior probability, and only involves a single variable, so it is similar to P(A), and can also be obtained from statistics, but because P(B) is independently in the denominator in Bayesian theorem In , the size of its specific value will not affect the determination result of the maximum posterior probability, and generally no calculation is required.</p>
</section>
<section id="naïve-bayes-nb-in-python-with-labeled-text-data" class="level2">
<h2 class="anchored" data-anchor-id="naïve-bayes-nb-in-python-with-labeled-text-data">Naïve Bayes (NB) in Python with Labeled Text Data</h2>
<p>In this section, I used Naive Bayes to predict sentiment analysis for test data Naive Bayes is a classification method based on Bayes’ Theorem and the assumption of predictor independence. It performs well in the case of categorical input variables compared to the numerical variables. I want to predict result which are negative, neutral, positive by using naive bayes.</p>
<p>First, split the dataset into train and test</p>
<p>Second, train Multinomial Naive Bayes model to predict text in x_test and calculate the accuracy</p>
<p>Finally, Make several visualizations and gather a conclusion.</p>
<section id="load-required-packages" class="level5">
<h5 class="anchored" data-anchor-id="load-required-packages">Load required packages</h5>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> MultinomialNB</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, accuracy_score</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="import-and-split-the-data" class="level5">
<h5 class="anchored" data-anchor-id="import-and-split-the-data">Import and split the data</h5>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tweettext <span class="op">=</span> pd.read_csv(<span class="st">"../data/01-modified-data/pytweetresult.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tweettext.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>text</th>
      <th>result</th>
      <th>scores</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>A more memorable connection is one that respec...</td>
      <td>Positive</td>
      <td>15.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>A more memorable connection is one that respec...</td>
      <td>Positive</td>
      <td>15.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>RT @OkeyMor57: @jay_scherrer @muskQu0tes @elon...</td>
      <td>Negative</td>
      <td>24.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>@jay_scherrer @muskQu0tes @elonmusk Elon Musk ...</td>
      <td>Negative</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>@DanKnightMMA Dear Dan - you seem like an enga...</td>
      <td>Positive</td>
      <td>26.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x_train,x_test,y_train,y_test<span class="op">=</span>train_test_split(tweettext[<span class="st">'text'</span>],tweettext[<span class="st">'result'</span>],test_size<span class="op">=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Since when we use Naive Bayes, we need to tranfer y(label data) into numeric column. As a result, LabelEncoder can greatly help us to tranform Y_train, Y_test value into 0,1,2 in order to simpler utilize Naive Bayes to calculate the result.</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Encoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Y_train <span class="op">=</span> Encoder.fit_transform(y_train) <span class="co">#Transform Y_train, Y_test value into 0,1,2</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Y_test<span class="op">=</span> Encoder.fit_transform(y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x_train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>557    Consumer privacy predictions—how marketers wil...
200    A more memorable connection is one that respec...
302    RT @OkeyMor57: @jay_scherrer @muskQu0tes @elon...
944    @elonmusk \n“But if Apple forsakes consumer pr...
594    FCC Acts To Protect Consumer Privacy From Unwa...
Name: text, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x_test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>973     Consumer privacy predictions—how marketers wil...
1246    Decentralized Identity: A New Era of Consumer ...
306     U.S. State Consumer Privacy Laws – a short 5-m...
531     RT @GRAUSAFL: Consumer Privacy in Retail from ...
345     Have you ever heard of self-sovereign distribu...
Name: text, dtype: object</code></pre>
</div>
</div>
</section>
<section id="naive-bayes-classification" class="level5">
<h5 class="anchored" data-anchor-id="naive-bayes-classification">Naive Bayes Classification</h5>
<p>There are three types of Bayesian classifiers, namely Multinomial Naive Bayes, Binarized Multinomial Naive Bayes, and Bernoulli Naive Bayes. This article describes the first Bayesian classifier, which is mainly used for text topic classification. In Multinomial Naive Bayes, the number of times a word appears, that is, term frequency (term frequency); and the second type—Binarized Multinomial Naive Bayes—does not consider word frequency, but only considers whether the word appears, and is mainly used for text sentiment analysis. For example, if a piece of text mentions the word bad, using the second classifier will not consider how many times bad appears, it only pays attention to whether bad appears.</p>
<p>For text classification, it is more suitable to use multinomial Naive Bayes Model. I built a model to fit x_train and Y_train, then make a prediction for x_test to determine whether Naive Bayes is a suitable model for sentiment analysis of prediction.</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use multinomial Naive Bayes model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> make_pipeline(TfidfVectorizer(), MultinomialNB())</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>model.fit(x_train,Y_train)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy: "</span>,accuracy_score(y_pred, Y_test)<span class="op">*</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy:  99.23076923076923</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>newdf <span class="op">=</span> pd.DataFrame(y_pred)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(y_pred)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(Y_test,color<span class="op">=</span><span class="st">'pink'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.legend(labels<span class="op">=</span>[<span class="st">"predict label"</span>,<span class="st">"true label"</span>])</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"predicted vs true"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Text(0.5, 1.0, 'predicted vs true')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Naive-Bayes1_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>From this plot, we can see the true labels are nearly as similar as predicted label. There is a few misclassification here. In the neutral column and positive column which are 1 and 2, there are a few misclassifications. But we can conclude that naive bayes is a good model here. We can enlarge train data in order to avoid some misclassifications.</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mat <span class="op">=</span> confusion_matrix(Y_test, y_pred)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(mat.T, square <span class="op">=</span> <span class="va">True</span>, annot<span class="op">=</span><span class="va">True</span>, fmt <span class="op">=</span> <span class="st">"d"</span>,yticklabels <span class="op">=</span> [<span class="st">'negative'</span>,<span class="st">'neutral'</span>,<span class="st">'positive'</span>], xticklabels<span class="op">=</span> [<span class="st">'negative'</span>,<span class="st">'neutral'</span>,<span class="st">'positive'</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"true labels"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"predicted label"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Naive-Bayes1_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In the heatmap shows above, it clearly shows the attitude distribution which are negative, neutral, positive between true labels and predicted labels. As we can see, the misclassification is low.</p>
</section>
<section id="further-prediction-for-using-naive-bayes-to-predict-scores-of-each-text" class="level5">
<h5 class="anchored" data-anchor-id="further-prediction-for-using-naive-bayes-to-predict-scores-of-each-text">Further prediction for using Naive Bayes to predict scores of each text</h5>
<p>From previous dataset, it not only defined attitude of each text, it also defined scores for each text. I would like to figure our whether a Naive Bayes Model is suitable for predict scores of each text.</p>
<p>First, calculate the frequencies of each scores and trying to bin them into different range</p>
<p>Second, split the dataset into train and test</p>
<p>Third, train Multinomial Naive Bayes model to predict text in x_test and calculate the accuracy</p>
<p>Finally Make several visualizations and gather a conclusion.</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> tweettext[<span class="st">'scores'</span>].value_counts().rename_axis(<span class="st">'scores'</span>).reset_index(name<span class="op">=</span><span class="st">'counts'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(rc<span class="op">=</span>{<span class="st">'figure.figsize'</span>:(<span class="dv">30</span>,<span class="dv">18</span>)})</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>freqplot <span class="op">=</span> sns.barplot(x<span class="op">=</span>freq.scores, y<span class="op">=</span>freq.counts)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>freqplot.set_title(<span class="st">"Distribution of scores"</span>,fontdict<span class="op">=</span> { <span class="st">'fontsize'</span>: <span class="dv">40</span>,<span class="st">'fontweight'</span>:<span class="st">'bold'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Text(0.5, 1.0, 'Distribution of scores')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Naive-Bayes1_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>From the plot, it clearly shows the distribution of each scores. At this time, because there are so many ranges of scores , we need to bin them</p>
<p>We classified each score to 5 ranges</p>
<p>First, we can find the max and min values of scores</p>
<p>We can use the linspace() function of the numpy package to calculate the 6 bins, equally distributed.</p>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>min_value <span class="op">=</span> tweettext[<span class="st">'scores'</span>].<span class="bu">min</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>max_value <span class="op">=</span> tweettext[<span class="st">'scores'</span>].<span class="bu">max</span>()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(min_value)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(max_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>6.2
100.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> np.linspace(min_value,max_value,<span class="dv">4</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>bins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array([  6.2       ,  37.46666667,  68.73333333, 100.        ])</code></pre>
</div>
</div>
<p>Now we define the labels and We can use the cut() function to convert the numeric values of the scores into the categorical values. We need to specify the bins and the labels. In addition, we set the parameter include_lowest to True in order to include also the minimum value.</p>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">'low'</span>,<span class="st">'medium'</span>,<span class="st">'high'</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tweettext[<span class="st">'scoresrange'</span>] <span class="op">=</span> pd.cut(tweettext[<span class="st">'scores'</span>], bins<span class="op">=</span>bins, labels<span class="op">=</span>labels, include_lowest<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>tweettext[<span class="st">'scoresrange'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0    low
1    low
2    low
3    low
4    low
Name: scoresrange, dtype: category
Categories (3, object): ['low' &lt; 'medium' &lt; 'high']</code></pre>
</div>
</div>
</section>
<section id="split-datset-into-train-and-test-and-train-naive-bayes" class="level5">
<h5 class="anchored" data-anchor-id="split-datset-into-train-and-test-and-train-naive-bayes">Split datset into train and test and Train Naive Bayes</h5>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>x_train,x_test,y_train,y_test<span class="op">=</span>train_test_split(tweettext[<span class="st">'text'</span>],tweettext[<span class="st">'scoresrange'</span>],test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> make_pipeline(TfidfVectorizer(), MultinomialNB())</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>model.fit(x_train,Y_train)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy: "</span>,accuracy_score(y_pred, Y_test)<span class="op">*</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy:  36.53846153846153</code></pre>
</div>
</div>
<p>The accuracy is low here, so we can predict that the Naive Bayes is not suitable for predict scores in each text.</p>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>newdf <span class="op">=</span> pd.DataFrame(y_pred)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(y_pred)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(Y_test,color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.legend(labels<span class="op">=</span>[<span class="st">"predict label"</span>,<span class="st">"true label"</span>])</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"predicted vs true"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>Text(0.5, 1.0, 'predicted vs true')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Naive-Bayes1_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As the plot shows, there are a lot of misclassification during the Naive baye prediction.</p>
</section>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion">Conclusion</h4>
<p>Naive Bayes in here is a great model to predict sentiment attitude. As we can see, the accuracy score is about 99. It means we only have about 2.5% misclassification. This can leads us to conclude that the attitude variable is independent. The Naive Bayes classifier is much faster with its probability calculations. This is the kind of algorithm used when all features follow a normal distribution. All features are continuous valued. The assumption is that there is no covariance between the independent features. We can further this model to analysis bigger dataset’s sentiment. In the following research, I will utilize more twitter api to gather the customers’ attitudes about consumer privacy, at this time, the naive bayes can be a useful tool to predict that.</p>
<p>However, for the further prefiction of each text’s score, the Naive Bayes is not a good model for prediction. I will try different model to predict that.</p>
</section>
</section>
<section id="naive-bayes-in-r" class="level2">
<h2 class="anchored" data-anchor-id="naive-bayes-in-r">Naive Bayes in R</h2>
<p>In this section, I used Naive Bayes to identify the relationship between influence scores and different factors of being a instagram influencer. Naive Bayes is a classification method based on Bayes’ Theorem and the assumption of predictor independence. It performs well in the case of categorical input variables compared to the numerical variables.</p>
<section id="load-required-packages-1" class="level5">
<h5 class="anchored" data-anchor-id="load-required-packages-1">Load required packages</h5>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import required packages</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>library(e1071)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>library(caTools)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>library(caret)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>library(plotly)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>library(dplyr)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>library(ggplot2)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>library(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-the-required-dataset" class="level5">
<h5 class="anchored" data-anchor-id="load-the-required-dataset">Load the required dataset</h5>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> read.csv(<span class="st">"../data/01-modified-data/instagram_infl.csv"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>head(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 11</caption>
<thead>
    <tr><th></th><th scope="col">X</th><th scope="col">rank</th><th scope="col">channel_info</th><th scope="col">influence_score</th><th scope="col">posts.k.</th><th scope="col">followers.m.</th><th scope="col">X60_day_eng_rate...</th><th scope="col">new_post_avg_like.m.</th><th scope="col">total_likes.b.</th><th scope="col">country</th><th scope="col">avg_likes</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>1</td><td>cristiano    </td><td>92</td><td>3.30</td><td>475.8</td><td>1.39</td><td>  6.5</td><td>29.0</td><td>Spain        </td><td>8700000</td></tr>
    <tr><th scope="row">2</th><td>2</td><td>2</td><td>kyliejenner  </td><td>91</td><td>6.90</td><td>366.2</td><td>1.62</td><td>  5.9</td><td>57.4</td><td>United States</td><td>8300000</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>3</td><td>leomessi     </td><td>90</td><td>0.89</td><td>357.3</td><td>1.24</td><td>  4.4</td><td> 6.0</td><td>Undefined    </td><td>6800000</td></tr>
    <tr><th scope="row">4</th><td>4</td><td>4</td><td>selenagomez  </td><td>93</td><td>1.80</td><td>342.7</td><td>0.97</td><td>  3.3</td><td>11.5</td><td>United States</td><td>6200000</td></tr>
    <tr><th scope="row">5</th><td>5</td><td>5</td><td>therock      </td><td>91</td><td>6.80</td><td>334.1</td><td>0.20</td><td>665.3</td><td>12.5</td><td>United States</td><td>1900000</td></tr>
    <tr><th scope="row">6</th><td>6</td><td>6</td><td>kimkardashian</td><td>91</td><td>5.60</td><td>329.2</td><td>0.88</td><td>  2.9</td><td>19.9</td><td>United States</td><td>3500000</td></tr>
</tbody>
</table>
</div>
</div>
<p>The dataset contains 11 columns.</p>
<p>influence score: It is calculated based on their popularity.</p>
<p>posts: total posts they have</p>
<p>followers: total followers they have</p>
<p>avg_likes: average likes of their total posts</p>
<p>60_days_eng_rate: 60 days of engagement rate</p>
<p>new_post_avg_like: a calculation of the average likes they gained from new posts.</p>
<p>total_likes: total likes of their posts in instagram.</p>
<p>country: users’ origin. What countries they from?</p>
</section>
<section id="identify-frequencies" class="level5">
<h5 class="anchored" data-anchor-id="identify-frequencies">Identify frequencies</h5>
<p>At this time, I want to calculate the distribution of influence scores.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>xtabs(<span class="op">~</span>data$influence_score, data <span class="op">=</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>data$influence_score
22 41 42 47 57 58 63 68 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 
 1  1  2  1  1  1  1  1  1  1  1  2  3  4  6  4  6  6 12  9 12 20 17 30 19  9 
88 89 90 91 92 93 
 7  4  7  6  4  1 </code></pre>
</div>
</div>
<p>Because there are so many scores in this datasets, It is more workable to take them into different bins like 0-75, 70-100 to identify the influence scores are high or low</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">&lt;-</span> data <span class="op">%&gt;%</span> mutate(new_bin <span class="op">=</span> cut(influence_score, breaks<span class="op">=</span>c(<span class="dv">0</span>,<span class="dv">77</span>,<span class="dv">84</span>,<span class="dv">100</span>)))<span class="co">#cut influence scores into different bins</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>data$new_bin <span class="op">&lt;-</span> <span class="im">as</span>.character(data$new_bin)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>data$new_bin[data$new_bin<span class="op">==</span><span class="st">"(0,77]"</span>]<span class="op">&lt;-</span><span class="st">"low"</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>data$new_bin[data$new_bin<span class="op">==</span><span class="st">"(77,84]"</span>]<span class="op">&lt;-</span><span class="st">"medium"</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>data$new_bin[data$new_bin<span class="op">==</span><span class="st">"(84,100]"</span>]<span class="op">&lt;-</span><span class="st">"high"</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Catergorized scores between 0-60 as low scores, 60-85 as medium scores,85-100 as high scores</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>data$new_bin <span class="op">&lt;-</span> <span class="im">as</span>.factor(data$new_bin) <span class="co"># Factorize the column new_bin for futher classification</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>head(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 12</caption>
<thead>
    <tr><th></th><th scope="col">X</th><th scope="col">rank</th><th scope="col">channel_info</th><th scope="col">influence_score</th><th scope="col">posts.k.</th><th scope="col">followers.m.</th><th scope="col">X60_day_eng_rate...</th><th scope="col">new_post_avg_like.m.</th><th scope="col">total_likes.b.</th><th scope="col">country</th><th scope="col">avg_likes</th><th scope="col">new_bin</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;fct&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>1</td><td>cristiano    </td><td>92</td><td>3.30</td><td>475.8</td><td>1.39</td><td>  6.5</td><td>29.0</td><td>Spain        </td><td>8700000</td><td>high</td></tr>
    <tr><th scope="row">2</th><td>2</td><td>2</td><td>kyliejenner  </td><td>91</td><td>6.90</td><td>366.2</td><td>1.62</td><td>  5.9</td><td>57.4</td><td>United States</td><td>8300000</td><td>high</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>3</td><td>leomessi     </td><td>90</td><td>0.89</td><td>357.3</td><td>1.24</td><td>  4.4</td><td> 6.0</td><td>Undefined    </td><td>6800000</td><td>high</td></tr>
    <tr><th scope="row">4</th><td>4</td><td>4</td><td>selenagomez  </td><td>93</td><td>1.80</td><td>342.7</td><td>0.97</td><td>  3.3</td><td>11.5</td><td>United States</td><td>6200000</td><td>high</td></tr>
    <tr><th scope="row">5</th><td>5</td><td>5</td><td>therock      </td><td>91</td><td>6.80</td><td>334.1</td><td>0.20</td><td>665.3</td><td>12.5</td><td>United States</td><td>1900000</td><td>high</td></tr>
    <tr><th scope="row">6</th><td>6</td><td>6</td><td>kimkardashian</td><td>91</td><td>5.60</td><td>329.2</td><td>0.88</td><td>  2.9</td><td>19.9</td><td>United States</td><td>3500000</td><td>high</td></tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="split-dataset-into-train-and-test" class="level5">
<h5 class="anchored" data-anchor-id="split-dataset-into-train-and-test">Split dataset into train and test</h5>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>split <span class="op">&lt;-</span> sample.split(data, SplitRatio <span class="op">=</span> <span class="fl">0.8</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>train <span class="op">&lt;-</span> subset(data, split <span class="op">==</span> <span class="st">"TRUE"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>test <span class="op">&lt;-</span> subset(data, split <span class="op">==</span> <span class="st">"FALSE"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>train <span class="op">&lt;-</span> subset(train,select <span class="op">=</span> <span class="op">-</span>c(X,channel_info,country,rank,influence_score)) <span class="co">#Drop columns which are not required</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>test <span class="op">&lt;-</span> subset(test,select <span class="op">=</span> <span class="op">-</span>c(X,channel_info,country,rank,influence_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>head(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">posts.k.</th><th scope="col">followers.m.</th><th scope="col">X60_day_eng_rate...</th><th scope="col">new_post_avg_like.m.</th><th scope="col">total_likes.b.</th><th scope="col">avg_likes</th><th scope="col">new_bin</th></tr>
    <tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;fct&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>3.30</td><td>475.8</td><td>1.39</td><td>6.5</td><td>29.0</td><td>8700000</td><td>high</td></tr>
    <tr><th scope="row">2</th><td>6.90</td><td>366.2</td><td>1.62</td><td>5.9</td><td>57.4</td><td>8300000</td><td>high</td></tr>
    <tr><th scope="row">3</th><td>0.89</td><td>357.3</td><td>1.24</td><td>4.4</td><td> 6.0</td><td>6800000</td><td>high</td></tr>
    <tr><th scope="row">4</th><td>1.80</td><td>342.7</td><td>0.97</td><td>3.3</td><td>11.5</td><td>6200000</td><td>high</td></tr>
    <tr><th scope="row">6</th><td>5.60</td><td>329.2</td><td>0.88</td><td>2.9</td><td>19.9</td><td>3500000</td><td>high</td></tr>
    <tr><th scope="row">7</th><td>5.00</td><td>327.7</td><td>1.20</td><td>3.9</td><td>18.4</td><td>3700000</td><td>high</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>head(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">posts.k.</th><th scope="col">followers.m.</th><th scope="col">X60_day_eng_rate...</th><th scope="col">new_post_avg_like.m.</th><th scope="col">total_likes.b.</th><th scope="col">avg_likes</th><th scope="col">new_bin</th></tr>
    <tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;fct&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">5</th><td> 6.80</td><td>334.1</td><td>0.20</td><td>665.3</td><td>12.5</td><td>1900000</td><td>high</td></tr>
    <tr><th scope="row">11</th><td> 0.66</td><td>254.0</td><td>2.04</td><td>  5.1</td><td> 3.7</td><td>5500000</td><td>high</td></tr>
    <tr><th scope="row">12</th><td>10.00</td><td>237.0</td><td>0.07</td><td>159.3</td><td> 3.0</td><td> 302200</td><td>high</td></tr>
    <tr><th scope="row">17</th><td> 6.40</td><td>201.6</td><td>0.53</td><td>  1.0</td><td>13.5</td><td>2100000</td><td>high</td></tr>
    <tr><th scope="row">23</th><td> 3.50</td><td>150.7</td><td>3.17</td><td>  4.8</td><td>20.6</td><td>5800000</td><td>high</td></tr>
    <tr><th scope="row">24</th><td> 1.60</td><td>140.5</td><td>1.10</td><td>  1.5</td><td> 5.0</td><td>3100000</td><td>low </td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pairs.panels(train[<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Naive-Bayes1_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Through this plot, we can get the first direct insight of this dataset.</p>
</section>
<section id="naive-bayes-classification-1" class="level5">
<h5 class="anchored" data-anchor-id="naive-bayes-classification-1">Naive Bayes Classification</h5>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">&lt;-</span> naiveBayes(new_bin <span class="op">~</span> ., data <span class="op">=</span> train, usekernel <span class="op">=</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">&lt;-</span> predict(model, newdata <span class="op">=</span> test)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="op">&lt;-</span> table(test$new_bin,y_pred) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>confusionMatrix(conf_mat) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>Confusion Matrix and Statistics

        y_pred
         high low medium
  high     11   1     10
  low       1   2      3
  medium    4   3     14

Overall Statistics
                                          
               Accuracy : 0.551           
                 95% CI : (0.4023, 0.6933)
    No Information Rate : 0.551           
    P-Value [Acc &gt; NIR] : 0.5589          
                                          
                  Kappa : 0.2545          
                                          
 Mcnemar's Test P-Value : 0.4625          

Statistics by Class:

                     Class: high Class: low Class: medium
Sensitivity               0.6875    0.33333        0.5185
Specificity               0.6667    0.90698        0.6818
Pos Pred Value            0.5000    0.33333        0.6667
Neg Pred Value            0.8148    0.90698        0.5357
Prevalence                0.3265    0.12245        0.5510
Detection Rate            0.2245    0.04082        0.2857
Detection Prevalence      0.4490    0.12245        0.4286
Balanced Accuracy         0.6771    0.62016        0.6002</code></pre>
</div>
</div>
</section>
<section id="build-a-heatmap-for-visualization" class="level5">
<h5 class="anchored" data-anchor-id="build-a-heatmap-for-visualization">Build a heatmap for visualization</h5>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>my_colors <span class="op">&lt;-</span> colorRampPalette(c(<span class="st">"pink"</span>, <span class="st">"blue"</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>heatmap(conf_mat,col <span class="op">=</span> my_colors(<span class="dv">3</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>legend(x<span class="op">=</span><span class="st">"right"</span>,legend <span class="op">=</span> c(<span class="st">"min"</span>, <span class="st">"med"</span>, <span class="st">"max"</span>),fill <span class="op">=</span> my_colors(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Naive-Bayes1_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="conclusion-1" class="level5">
<h5 class="anchored" data-anchor-id="conclusion-1">Conclusion</h5>
<p>As we can see in the confusion matrix, The accuracy is only low for prediction. At this time, Naive Bayes is not a good model for this dataset. In naive Bayes algorithm, we calculate the conditional probability of the events given class label. However in testing data, if some new event comes up then the conditional probability will be zero for the entire term. As a result, it is may be not useful for this dataset because other variables don’t give a great prediction for influencers’ scores. Influencer score may be not a independent variable.</p>
</section>
<section id="train-another-model-in-the-same-plots" class="level5">
<h5 class="anchored" data-anchor-id="train-another-model-in-the-same-plots">Train another model in the same plots</h5>
<p>At this time, I want to total likes amount to train influence model too determine whether there are other interrupted variables lower the accuracy</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">&lt;-</span> naiveBayes(new_bin <span class="op">~</span> total_likes.b., data <span class="op">=</span> train, usekernel <span class="op">=</span> T) </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">&lt;-</span> predict(model, newdata <span class="op">=</span> test)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="op">&lt;-</span> table(test$new_bin,y_pred) </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>confusionMatrix(conf_mat) </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>my_colors <span class="op">&lt;-</span> colorRampPalette(c(<span class="st">"pink"</span>, <span class="st">"blue"</span>))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>heatmap(conf_mat,col <span class="op">=</span> my_colors(<span class="dv">3</span>))</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>legend(x<span class="op">=</span><span class="st">"right"</span>,legend <span class="op">=</span> c(<span class="st">"min"</span>, <span class="st">"med"</span>, <span class="st">"max"</span>),fill <span class="op">=</span> my_colors(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>Confusion Matrix and Statistics

        y_pred
         high low medium
  high     19   0      3
  low       4   0      2
  medium   15   0      6

Overall Statistics
                                          
               Accuracy : 0.5102          
                 95% CI : (0.3634, 0.6558)
    No Information Rate : 0.7755          
    P-Value [Acc &gt; NIR] : 0.999988        
                                          
                  Kappa : 0.1184          
                                          
 Mcnemar's Test P-Value : 0.002905        

Statistics by Class:

                     Class: high Class: low Class: medium
Sensitivity               0.5000         NA        0.5455
Specificity               0.7273     0.8776        0.6053
Pos Pred Value            0.8636         NA        0.2857
Neg Pred Value            0.2963         NA        0.8214
Prevalence                0.7755     0.0000        0.2245
Detection Rate            0.3878     0.0000        0.1224
Detection Prevalence      0.4490     0.1224        0.4286
Balanced Accuracy         0.6136         NA        0.5754</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Naive-Bayes1_files/figure-html/cell-29-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="conclusion-2" class="level5">
<h5 class="anchored" data-anchor-id="conclusion-2">Conclusion</h5>
<p>Because the accuracy is still low at this time, we can conclude that Naive Bayes is not suitable for this model.</p>
</section>
<section id="reference" class="level5">
<h5 class="anchored" data-anchor-id="reference">Reference</h5>
<p>Wikimedia Foundation. (2022, October 29). Naive Bayes classifier. Wikipedia. Retrieved December 1, 2022, from https://en.wikipedia.org/wiki/Naive_Bayes_classifier</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>