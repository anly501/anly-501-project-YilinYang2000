<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.649">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ARM and Networking</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ARM_files/libs/clipboard/clipboard.min.js"></script>
<script src="ARM_files/libs/quarto-html/quarto.js"></script>
<script src="ARM_files/libs/quarto-html/popper.min.js"></script>
<script src="ARM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ARM_files/libs/quarto-html/anchor.min.js"></script>
<link href="ARM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ARM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ARM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ARM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ARM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ARM and Networking</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<section id="dataset-introduction" class="level4">
<h4 class="anchored" data-anchor-id="dataset-introduction">Dataset Introduction</h4>
<p>This dataset contains text I collected from twitter api. The text mainly talks about the users’ reviews about consumers privacy by using media. Since I have preprocessed the text and remove stopwords, I need to just tokenize the data for preprocessing.</p>
</section>
<section id="method-introduction" class="level4">
<h4 class="anchored" data-anchor-id="method-introduction">Method Introduction</h4>
<p>In data mining and machine learning, Association Rules is a relatively commonly used unsupervised learning algorithm. Different from the classification and clustering algorithms we have learned before, the main purpose of this type of algorithm is to ——Explore the correlation between the inherent structural features (ie variables) of the data.</p>
<p>To put it simply, it is to find some meaningful and valuable relationships in large-scale data sets. With these relationships, on the one hand, it can help us broaden our understanding of data and its characteristics; on the other hand, it can realize the construction and application of recommendation systems (such as shopping basket analysis, etc.).</p>
<p>After we have a basic understanding of association rules, we further subdivide them. Taking the association in daily life as an example, among the customers who visit the supermarket, those who buy bread will largely buy milk. The association of classes is called simple association rules ; for another example, many customers who buy car sun visors will buy zero-degree glass of water in the near future. Such cases not only reflect the association relationship between things, but also have a time sequence , so this type of association is called sequence association rules.</p>
<p>Association rules in a broad sense include simple association and sequence association. Next, we will conduct in-depth study on these two pieces of knowledge respectively.</p>
<ol type="1">
<li>Confidence Definition: Assume that among the transactions in W that support item set A , c % of the transactions also support item set B, and c % is called the credibility of the association rule A → B.</li>
</ol>
<p>Popular explanation: Simply put, credibility refers to the probability that item set B also appears in a transaction T in which item set A appears.</p>
<p>Example: In the above example of a ballpoint pen and a notebook, the credibility of the association rule answers the question: If a customer buys a ballpoint pen, how likely is it that he also buys a notebook? In the example above, 65 % of customers who bought ballpoint pens bought notebooks, so the confidence level is 65 %.</p>
<p>Probability description: the confidence of item set A to item set B (A==&gt;B)=P(A|B)</p>
<ol start="2" type="1">
<li>Support Definition: Let s% of transactions in W support item sets A and B at the same time, s % is called the support degree of association rule A→B . The support degree describes how likely the union C of the two item sets A and B appears in all transactions.</li>
</ol>
<p>Popular explanation: Simply put, the support of A==&gt;B refers to the probability that item set A and item set B appear at the same time.</p>
<p>Example: A total of 1,000 customers went to the mall to buy items on a certain day, and 150 of them bought ballpoint pens and notebooks at the same time, so the support of the above association rule is 15%.</p>
<p>Probability description: item set A supports item set B support (A==&gt;B)=P(A n B)</p>
<ol start="3" type="1">
<li>Expected confidence Definition: Let e% of transactions in W support item set B, and e % is called the expected credibility of association rule A→B.</li>
</ol>
<p>Popular explanation: the expected credibility describes the probability of item set B appearing in all transactions without any conditional influence.</p>
<p>Example illustration: If a total of 1000 customers went to the mall to purchase items on a certain day, and 250 of them purchased ballpoint pens, then the expected reliability of the above association rule is 25%.</p>
<p>Probability description: The expected confidence of item set A to item set B is support(B)=P(B)</p>
<ol start="4" type="1">
<li>Lift (lift) Definition: Lift is the ratio of credibility to expected credibility</li>
</ol>
<p>Popular explanation: The degree of promotion reflects how much the occurrence probability of item set B has changed from “the appearance of item set A”.</p>
<p>Example description: The promotion degree of the above association rules = 65%/25% = 2.6</p>
<p>Probability description: The expected confidence of item set A on item set B is lift (A==&gt;B) = confidence (A==&gt;B)/support(B)=p(B|A)/p(B)</p>
<p>In short, credibility is a measure of the accuracy of association rules, and support is a measure of the importance of association rules. The degree of support shows how representative this rule is in all transactions. Obviously, the greater the degree of support, the more important the association rule is. Although some association rules have high credibility, their support is very low, which means that the association rule has little chance of being practical, so it is not important.</p>
</section>
<section id="process" class="level4">
<h4 class="anchored" data-anchor-id="process">Process</h4>
<ol type="1">
<li><p>Load the required packages and dataset</p></li>
<li><p>Preprocessed the data. Use nltk.tokenize to split sentences as word by word.</p></li>
<li><p>Re-format output</p></li>
<li><p>Convert to NetworkX object</p></li>
<li><p>Plot NetworkX object</p></li>
<li><p>Train ARM model</p></li>
<li><p>Visualize the results</p></li>
</ol>
</section>
</section>
<section id="method" class="level2">
<h2 class="anchored" data-anchor-id="method">Method</h2>
<section id="load-the-required-packages" class="level4">
<h4 class="anchored" data-anchor-id="load-the-required-packages">Load the required packages</h4>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> PorterStemmer</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.sentiment <span class="im">import</span> SentimentIntensityAnalyzer</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> apyori <span class="im">import</span> apriori</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="load-the-required-dataset" class="level4">
<h4 class="anchored" data-anchor-id="load-the-required-dataset">Load the required dataset</h4>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'../data/01-modified-data/tweetresult.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[<span class="st">'0'</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>transactions<span class="op">=</span> [word_tokenize(df[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df))]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>transactions[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[['memorable',
  'connection',
  'respect',
  'consumer',
  'privacy',
  'unfold',
  'right',
  'moment',
  'audience',
  'target',
  'contextual',
  'solution'],
 ['memorable',
  'connection',
  'respect',
  'consumer',
  'privacy',
  'unfold',
  'right',
  'moment',
  'audience',
  'target',
  'contextual',
  'solution'],
 ['rt',
  'okeymornumber',
  'jay_scherrer',
  'muskqunumberte',
  'elonmusk',
  'elon',
  'musk',
  'challenge',
  'donald',
  'trump',
  'title',
  'shameless',
  'liar',
  'apple'],
 ['jay_scherrer',
  'muskqunumberte',
  'elonmusk',
  'elon',
  'musk',
  'challenge',
  'donald',
  'trump',
  'title',
  'shameless',
  'liar',
  'apple',
  'search',
  'engine',
  'exert',
  'control',
  'echo',
  'system',
  'protect',
  'consumer',
  'privacy',
  'security'],
 ['danknightmma',
  'dear',
  'dan',
  'like',
  'engage',
  'canadian',
  'read',
  'bill',
  'explain',
  'modernize',
  'consumer',
  'privacy',
  'law',
  'bad',
  'canadians',
  'thank',
  'billcnumber',
  'cdnpoli',
  'https',
  't',
  'co',
  'zfnumberifvzdbnumber']]</code></pre>
</div>
</div>
</section>
</section>
<section id="function-introduction" class="level2">
<h2 class="anchored" data-anchor-id="function-introduction">Function Introduction</h2>
<p>After tokenize the text, we can move forward to use several functions to train the ARM model.</p>
<p>The reformat_results function are used to reformat the tokenized dataframe by using apriori algorithm. And store them into columns “rhs”,“lhs”,“supp”,“conf”,“supp*conf”,“lift”.</p>
<p>What is apriori algorithm?</p>
<p>Apriori Algorithm is one of the classic algorithms for association rule learning .</p>
<p>The prior algorithm is designed to work with databases containing transactional information content. For example, a list of products purchased by customers, or a list of frequently visited web pages, etc.</p>
<p>The prior algorithm uses the breadth -first search algorithm to search and uses the tree structure to efficiently count the candidate itemsets. A candidate item set of length k is generated from a candidate item set of length k−1 , and then candidates containing uncommon subpatterns are removed from it. According to the downward closure lemma, the candidate itemset contains all frequent itemsets of length k. After that, the frequent itemsets in the candidate itemsets can be determined by scanning the transaction database.</p>
<p>convert_to_network and plot_network are utilized for the final plots which are the RESULTS AS A NETWORK-X OBJECT</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reformat_results(results):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    keep<span class="op">=</span>[]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(results)):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(<span class="bu">list</span>(results[i]))):</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(j<span class="op">&gt;</span><span class="dv">1</span>):</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(<span class="bu">list</span>(results[i][j]))):</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span>(<span class="bu">len</span>(results[i][j][k][<span class="dv">0</span>])<span class="op">!=</span><span class="dv">0</span>):</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                        rhs<span class="op">=</span><span class="bu">list</span>(results[i][j][k][<span class="dv">0</span>])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                        lhs<span class="op">=</span><span class="bu">list</span>(results[i][j][k][<span class="dv">1</span>])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                        conf<span class="op">=</span><span class="bu">float</span>(results[i][j][k][<span class="dv">2</span>])</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                        lift<span class="op">=</span><span class="bu">float</span>(results[i][j][k][<span class="dv">3</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                        keep.append([rhs,lhs,supp,conf,supp<span class="op">*</span>conf,lift])</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(j<span class="op">==</span><span class="dv">1</span>):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                supp<span class="op">=</span>results[i][j]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(keep, columns<span class="op">=</span>[<span class="st">"rhs"</span>,<span class="st">"lhs"</span>,<span class="st">"supp"</span>,<span class="st">"conf"</span>,<span class="st">"supp*conf"</span>,<span class="st">"lift"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_network(df):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#BUILD GRAPH</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> nx.DiGraph()  <span class="co"># DIRECTED</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> df.iterrows():</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for column in df.columns:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        lhs<span class="op">=</span><span class="st">"_"</span>.join(row[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        rhs<span class="op">=</span><span class="st">"_"</span>.join(row[<span class="dv">1</span>][<span class="dv">1</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        conf<span class="op">=</span>row[<span class="dv">1</span>][<span class="dv">3</span>]<span class="op">;</span> <span class="co">#print(conf)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(lhs <span class="kw">not</span> <span class="kw">in</span> G.nodes): </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            G.add_node(lhs)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(rhs <span class="kw">not</span> <span class="kw">in</span> G.nodes): </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            G.add_node(rhs)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        edge<span class="op">=</span>(lhs,rhs)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> edge <span class="kw">not</span> <span class="kw">in</span> G.edges:</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>            G.add_edge(lhs, rhs, weight<span class="op">=</span>conf)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(G.nodes)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(G.edges)</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_network(G):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#SPECIFIY X-Y POSITIONS FOR PLOTTING</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    pos<span class="op">=</span>nx.random_layout(G)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#GENERATE PLOT</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    fig.set_size_inches(<span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#assign colors based on attributes</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    weights_e   <span class="op">=</span> [G[u][v][<span class="st">'weight'</span>] <span class="cf">for</span> u,v <span class="kw">in</span> G.edges()]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#SAMPLE CMAP FOR COLORS </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>plt.cm.get_cmap(<span class="st">'Blues'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    colors_e    <span class="op">=</span> [cmap(G[u][v][<span class="st">'weight'</span>]<span class="op">*</span><span class="dv">10</span>) <span class="cf">for</span> u,v <span class="kw">in</span> G.edges()]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    nx.draw(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    G,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    edgecolors<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    edge_color<span class="op">=</span>colors_e,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    linewidths<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    font_size<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    font_color<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    font_weight<span class="op">=</span><span class="st">"bold"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span>weights_e,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    with_labels<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    pos<span class="op">=</span>pos,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Dracula'</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co"># raise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="train-arm-model" class="level2">
<h2 class="anchored" data-anchor-id="train-arm-model">Train ARM model</h2>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># INSERT CODE TO TRAIN THE ARM MODEL USING THE "apriori" PACKAGE</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Transactions:"</span>,pd.DataFrame(transactions).head())</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="bu">list</span>(apriori(transactions, min_support<span class="op">=</span><span class="fl">0.05</span>, min_confidence<span class="op">=</span><span class="fl">0.05</span>, min_length<span class="op">=</span><span class="dv">1</span>, min_lift<span class="op">=</span><span class="dv">0</span>, max_length<span class="op">=</span><span class="dv">10</span>))     <span class="co">#RUN APRIORI ALGORITHM</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>pd_results<span class="op">=</span>reformat_results(results)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd_results.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Transactions:              0               1             2               3         4   \
0     memorable      connection       respect        consumer   privacy   
1     memorable      connection       respect        consumer   privacy   
2            rt   okeymornumber  jay_scherrer  muskqunumberte  elonmusk   
3  jay_scherrer  muskqunumberte      elonmusk            elon      musk   
4  danknightmma            dear           dan            like    engage   

          5       6          7         8          9   ...    25    26    27  \
0     unfold   right     moment  audience     target  ...  None  None  None   
1     unfold   right     moment  audience     target  ...  None  None  None   
2       elon    musk  challenge    donald      trump  ...  None  None  None   
3  challenge  donald      trump     title  shameless  ...  None  None  None   
4   canadian    read       bill   explain  modernize  ...  None  None  None   

     28    29    30    31    32    33    34  
0  None  None  None  None  None  None  None  
1  None  None  None  None  None  None  None  
2  None  None  None  None  None  None  None  
3  None  None  None  None  None  None  None  
4  None  None  None  None  None  None  None  

[5 rows x 35 columns]
(7198066, 6)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># INSERT CODE TO PLOT THE RESULTS AS A NETWORK-X OBJECT </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>G<span class="op">=</span>convert_to_network(pd_results[<span class="dv">0</span>:<span class="dv">25</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plot_network(G)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           rhs         lhs  supp      conf  supp*conf       lift
0        [act]       [amp]  0.06  0.600000   0.036000   6.666667
1        [amp]       [act]  0.06  0.666667   0.040000   6.666667
2        [act]        [co]  0.09  0.900000   0.081000   1.500000
3         [co]       [act]  0.09  0.150000   0.013500   1.500000
4        [act]  [consumer]  0.10  1.000000   0.100000   1.149425
5   [consumer]       [act]  0.10  0.114943   0.011494   1.149425
6        [act]     [https]  0.09  0.900000   0.081000   1.475410
7      [https]       [act]  0.09  0.147541   0.013279   1.475410
8        [act]   [privacy]  0.10  1.000000   0.100000   1.149425
9    [privacy]       [act]  0.10  0.114943   0.011494   1.149425
10       [act]         [t]  0.09  0.900000   0.081000   1.475410
11         [t]       [act]  0.09  0.147541   0.013279   1.475410
12        [ad]  [consumer]  0.05  1.000000   0.050000   1.149425
13  [consumer]        [ad]  0.05  0.057471   0.002874   1.149425
14        [ad]   [privacy]  0.05  1.000000   0.050000   1.149425
15   [privacy]        [ad]  0.05  0.057471   0.002874   1.149425
16   [adviser]    [agency]  0.07  1.000000   0.070000  14.285714
17    [agency]   [adviser]  0.07  1.000000   0.070000  14.285714
18   [adviser]       [ask]  0.07  1.000000   0.070000  14.285714
19       [ask]   [adviser]  0.07  1.000000   0.070000  14.285714
20   [adviser]     [biden]  0.07  1.000000   0.070000  14.285714
21     [biden]   [adviser]  0.07  1.000000   0.070000  14.285714
22   [adviser]      [blaw]  0.06  0.857143   0.051429  14.285714
23      [blaw]   [adviser]  0.06  1.000000   0.060000  14.285714
24   [adviser]  [congress]  0.07  1.000000   0.070000   7.692308</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ARM_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As we can see in the plot, it clearly show some main relationships with words to words.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Advantages and disadvantages of Apriori algorithm</p>
<p>Advantages:</p>
<ol type="1">
<li><p>The Aprioi algorithm adopts the iterative method of layer-by-layer search, the algorithm is simple and clear, there is no complicated theoretical derivation, and it is easy to implement.</p></li>
<li><p>Data is organized horizontally</p></li>
<li><p>Apriori optimization method is used</p></li>
<li><p>It is suitable for association rule mining of transactional database.</p></li>
<li><p>Suitable for sparse data sets: According to previous research, this algorithm can only be suitable for association rule mining of sparse data</p></li>
</ol>
<p>sets, that is, data sets with a slightly smaller length of frequent itemsets.</p>
<p>Defects:</p>
<ol type="1">
<li><p>Too many scans to the database.</p></li>
<li><p>The Apion algorithm may generate a large number of candidate itemsets.</p></li>
<li><p>When the length of frequent itemsets becomes larger, the operation time increases significantly.</p></li>
<li><p>The unique support degree is adopted, without considering the difference in the importance of each attribute.</p></li>
<li><p>The adaptability of the algorithm is narrow.</p></li>
</ol>
<section id="reference" class="level4">
<h4 class="anchored" data-anchor-id="reference">Reference</h4>
<p>Wikimedia Foundation. (2022, December 2). Association rule learning. Wikipedia. Retrieved December 4, 2022, from https://en.wikipedia.org/wiki/Association_rule_learning</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>