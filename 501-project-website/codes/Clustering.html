<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.649">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Decision Tree for record data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Clustering_files/libs/clipboard/clipboard.min.js"></script>
<script src="Clustering_files/libs/quarto-html/quarto.js"></script>
<script src="Clustering_files/libs/quarto-html/popper.min.js"></script>
<script src="Clustering_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Clustering_files/libs/quarto-html/anchor.min.js"></script>
<link href="Clustering_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Clustering_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Clustering_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Clustering_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Clustering_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Decision Tree for record data</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<section id="dataset-introduction" class="level4">
<h4 class="anchored" data-anchor-id="dataset-introduction">Dataset Introduction</h4>
<section id="first-dataset-advertiments-click" class="level5">
<h5 class="anchored" data-anchor-id="first-dataset-advertiments-click">First Dataset: Advertiments click</h5>
<p>Advertisements is one of the important sources for internet influencers to earn benefits and money from social media platforms. In this dataset, we will work on an advertising dataset. There are many features to determine whether internet users will click on advertisements.</p>
<pre><code>This datasets contain these columns:


Daily Time Spent on Site: internet users' time consumptions on site in minutes


Age: Internet users' ages in years


Area Income: Internet users' average incomes in geographical area


Daily Internet Usage: Daily average internet time consumptions of internet users in minutes


Ad Topic Line: Headline of the advertisement


City: City of consumer


Male: Whether or not consumer was male


Country: Country of consumer


Timestamp: Time at which consumer clicked on Ad or closed window


Clicked on Ad: 0 or 1 indicated clicking on Ad</code></pre>
</section>
<section id="instagram-influencers" class="level5">
<h5 class="anchored" data-anchor-id="instagram-influencers">Instagram Influencers</h5>
<p>Instagram is very popular nowadays among the world. People in different countries like to use this media platform to share their lives, post some exciting moments and connect with their families and friends. There are some instagram influencers can use the platform to gather likes from their fans, use their popularity to promote some advertisements in order to gain benefits from instagram. This dataset talks about how to measure the influence score among influencers. Here are the column introduction for this dataset.</p>
<pre><code>channel info: Username in instagram

influence score: It is calculated based on their popularity.

posts: total posts they have

followers: total followers they have

avg_likes: average likes of their total posts

60_days_eng_rate: 60 days of engagement rate

new_post_avg_like: a calculation of the average likes they gained from new posts. 

total_likes: total likes of their posts in instagram.

country: users' origin. What countries they from?</code></pre>
</section>
</section>
<section id="introduction-to-clustering" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-clustering">introduction to clustering</h4>
<p>Clustering is an unsupervised learning method. We will use clustering to find the find useful features, explanatory underlying processes, significent structures, and set groups for them. Clustering will assign datapoints to certain groups since they are similar to each other and each group are totally distinct with other groups. We can find the representatives of homogeneous groups and the differences between different groups. More than this, we can also determine the unextraodinary outliers and analyze them.</p>
<p>Clustering is really important for first dataset because it can determine the instrinct relationships between unlabelled datasets. The internet influencers can make a decision to determine they can greatly suitable for which types of users in order to achieve the biggest benefits.</p>
<p>In the second dataset, clustering can help salers to cluster homogeneous factors together in order to get more persuasive and accurate result to determine which kind of internet influencer is most suitable for their products.</p>
<p>In these datasets, we will use three kinds of methods of clustering and compare their accuracy and feasibility to determine which method is the most suitable to do clustering and reach conclusions.</p>
<p>The three methods of clustering:</p>
<p>K means</p>
<p>DBSAN</p>
<p>Hierarchical clustering</p>
</section>
</section>
<section id="theory" class="level3">
<h3 class="anchored" data-anchor-id="theory">Theory</h3>
<section id="k-means" class="level4">
<h4 class="anchored" data-anchor-id="k-means">K means</h4>
<p>K means Clustering in Machine Learning is one of the simplest methods among all clustering methods for unsupervised learning.</p>
<p>Firstly, the K mean will randomly selected centroids by using starting points of every cluster, and then repeat and repeat again to make an optimization of the cetroids’ location.</p>
<p>How K means clustering implemented in this project?</p>
<pre><code>Step1: We'll use Scikit-learn library to import K-mean clustering method

Step2: Do feature selections and EDA to firstly plot the datasets and know datasets better

Step3: Hyperparameter tunning to find the optimal cluster size

Step4: Make a visualization plot for final results and evaluate the model</code></pre>
</section>
<section id="dbsan" class="level4">
<h4 class="anchored" data-anchor-id="dbsan">DBSAN</h4>
<p>Density-based sptial clustering of Application with Noise is a density-based clustering. It is a great method for large datasets with noisy data points and outliers. The difference between DBSAN and K mean is that when the datasets are not organized enough, K-mean clustering has difficulty to process the datasets, but DBSAN can handle clusters of different sizes and datasets with noisy datas and outliers.</p>
<p>How DBSAN clustering implemented in this project?</p>
<pre><code>STEP1&amp;2 are similar as K-mean

STEP3: Hyperparameter tunning to find the optimal eps and min_sample size

STEP4: Make a visualization plot for final results of DBSAN after the hyperparameter tunning and evaluate the method.</code></pre>
</section>
<section id="hierarchical-clusteringagglomerative-clustering" class="level4">
<h4 class="anchored" data-anchor-id="hierarchical-clusteringagglomerative-clustering">Hierarchical Clustering(Agglomerative Clustering)</h4>
<p>Agglomerative Clustering is one of the Hierarchical Clustering algorithm. It is also used for unsupervised machine learning. The hierarchical clustering is worked as how its name shows, it seeks to build hierarchical clusters to find the homogeneous points with similar clusters. The interesting thing is that Agglomerative clustering works through bottom to up, each data point is considered as individual objects, when two points are similar, they will get clustered into bigger groups.</p>
<p>How Agglomerative Clustering implemented in this project?</p>
<pre><code>STEP1&amp;2 are similar as K-mean

STEP3: Make a visualization plot of Dendrogram

STEP3: Use Dendrogram to do hyperparameter tunning to find the optimal numbers of clusters

STEP4: Make a visualization plot for final results of Aggolomerative Clustering after the hyperparameter tunning and evaluate the method.</code></pre>
<p>First, Load the required package for futhuer exploration</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statistics <span class="im">import</span> mode</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial.distance <span class="im">import</span> cdist</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, ConfusionMatrixDisplay, accuracy_score</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> DBSCAN</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_samples, silhouette_score</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> dendrogram, linkage</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> AgglomerativeClustering</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
</section>
<section id="methods-for-advertisement-dataset" class="level3">
<h3 class="anchored" data-anchor-id="methods-for-advertisement-dataset">Methods (for advertisement dataset)</h3>
<section id="preprocess-the-dataset-and-eda" class="level4">
<h4 class="anchored" data-anchor-id="preprocess-the-dataset-and-eda">Preprocess the dataset and EDA</h4>
<p>Input the advertising dataset and drop the nonnumeric column.</p>
<p>As we can see, ‘clicked on Ad’ column is a labeled column, we cannot store it as X for the future clustering</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>adv <span class="op">=</span> pd.read_csv(<span class="st">"../data/00-raw-data/advertising.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>adv <span class="op">=</span> adv.select_dtypes([<span class="st">'number'</span>])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>adv.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Daily Time Spent on Site</th>
      <th>Age</th>
      <th>Area Income</th>
      <th>Daily Internet Usage</th>
      <th>Male</th>
      <th>Clicked on Ad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>68.95</td>
      <td>35</td>
      <td>61833.90</td>
      <td>256.09</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.23</td>
      <td>31</td>
      <td>68441.85</td>
      <td>193.77</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69.47</td>
      <td>26</td>
      <td>59785.94</td>
      <td>236.50</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>74.15</td>
      <td>29</td>
      <td>54806.18</td>
      <td>245.89</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>68.37</td>
      <td>35</td>
      <td>73889.99</td>
      <td>225.58</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Firstly explore datasets, find whether there are some NA values in the datasets, if yes, drop the NA values.</p>
<p>Then do EDA with datasets, make some visualization plots and first analyze the datasets.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>adv.describe().transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Daily Time Spent on Site</th>
      <td>1000.0</td>
      <td>65.00020</td>
      <td>15.853615</td>
      <td>32.60</td>
      <td>51.3600</td>
      <td>68.215</td>
      <td>78.5475</td>
      <td>91.43</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>1000.0</td>
      <td>36.00900</td>
      <td>8.785562</td>
      <td>19.00</td>
      <td>29.0000</td>
      <td>35.000</td>
      <td>42.0000</td>
      <td>61.00</td>
    </tr>
    <tr>
      <th>Area Income</th>
      <td>1000.0</td>
      <td>55000.00008</td>
      <td>13414.634022</td>
      <td>13996.50</td>
      <td>47031.8025</td>
      <td>57012.300</td>
      <td>65470.6350</td>
      <td>79484.80</td>
    </tr>
    <tr>
      <th>Daily Internet Usage</th>
      <td>1000.0</td>
      <td>180.00010</td>
      <td>43.902339</td>
      <td>104.78</td>
      <td>138.8300</td>
      <td>183.130</td>
      <td>218.7925</td>
      <td>269.96</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>1000.0</td>
      <td>0.48100</td>
      <td>0.499889</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.000</td>
      <td>1.0000</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>Clicked on Ad</th>
      <td>1000.0</td>
      <td>0.50000</td>
      <td>0.500250</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.500</td>
      <td>1.0000</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>adv.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 6 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   Daily Time Spent on Site  1000 non-null   float64
 1   Age                       1000 non-null   int64  
 2   Area Income               1000 non-null   float64
 3   Daily Internet Usage      1000 non-null   float64
 4   Male                      1000 non-null   int64  
 5   Clicked on Ad             1000 non-null   int64  
dtypes: float64(3), int64(3)
memory usage: 47.0 KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>adv.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Daily Time Spent on Site    0
Age                         0
Area Income                 0
Daily Internet Usage        0
Male                        0
Clicked on Ad               0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(data<span class="op">=</span>adv,hue<span class="op">=</span><span class="st">'Clicked on Ad'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x7fea9b8a0580&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Here is the pairplot shows the relationship between each columns, and the clustering of whether internet users clicked on advertisements. We can take a instinct insight of datasets.</p>
<section id="seperate-the-dataset-into-features" class="level5">
<h5 class="anchored" data-anchor-id="seperate-the-dataset-into-features">Seperate the dataset into features</h5>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> adv[[<span class="st">'Daily Time Spent on Site'</span>,<span class="st">'Daily Internet Usage'</span>]]<span class="co">#Choose two features for the further clustering</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>scalar <span class="op">=</span> StandardScaler()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>scalar.fit(X)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scalar.transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
</section>
<section id="use-k-mean-clustering-to-process-the-datasets-and-predict-the-model" class="level4">
<h4 class="anchored" data-anchor-id="use-k-mean-clustering-to-process-the-datasets-and-predict-the-model">Use K-mean Clustering to process the datasets and predict the model</h4>
<section id="hyperparameter-tunning" class="level5">
<h5 class="anchored" data-anchor-id="hyperparameter-tunning">Hyperparameter tunning</h5>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for k means clustering we will use the elbow method to find the optimal number of clusters. we will use the inertia_ attribute to find the sum of squared distances of samples to their closest cluster center. we will use the range of 1 to 10 clusters. plot the inertia_ values for each number of clusters. make sure to save it in a dataframe and plot it using matplotlib.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>distortions <span class="op">=</span> []</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>inertias <span class="op">=</span> []</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,k):</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    kmeanModel <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k, init<span class="op">=</span><span class="st">'k-means++'</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    kmeanModel.fit(X)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    distortions.append(<span class="bu">sum</span>(np.<span class="bu">min</span>(cdist(X, kmeanModel.cluster_centers_, <span class="st">'euclidean'</span>),axis<span class="op">=</span><span class="dv">1</span>))<span class="op">/</span>X.shape[<span class="dv">0</span>])</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    inertias.append(kmeanModel.inertia_)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    evaluation <span class="op">=</span> pd.DataFrame.from_records({<span class="st">'Cluster'</span>:np.arange(<span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>), <span class="st">'Distortion'</span>:distortions, <span class="st">"Inertia"</span>:inertias})</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>evaluation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Cluster</th>
      <th>Distortion</th>
      <th>Inertia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1.354428</td>
      <td>2000.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.742440</td>
      <td>692.500182</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.615420</td>
      <td>476.346131</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.529527</td>
      <td>351.434006</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.483688</td>
      <td>293.790219</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.442116</td>
      <td>243.475153</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.412500</td>
      <td>209.567018</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.386317</td>
      <td>181.678764</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.360663</td>
      <td>161.099235</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.342820</td>
      <td>143.415939</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot distortion and inertia for kmeans, you can either plot them seperately or use fig, ax = plt.subplots(1, 2) to plot them in the same figure. Suggest the optimal number of clusters based on the plot.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>evaluation.plot.line(x <span class="op">=</span> <span class="st">'Cluster'</span>, subplots<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([&lt;AxesSubplot:xlabel='Cluster'&gt;, &lt;AxesSubplot:xlabel='Cluster'&gt;],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yellowbrick.cluster <span class="im">import</span> KElbowVisualizer</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Elbow Method to determine the number of clusters to be formed:'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Elbow_M <span class="op">=</span> KElbowVisualizer(KMeans(), k<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>Elbow_M.fit(X)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Elbow_M.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Elbow Method to determine the number of clusters to be formed:</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>&lt;AxesSubplot:title={'center':'Distortion Score Elbow for KMeans Clustering'}, xlabel='k', ylabel='distortion score'&gt;</code></pre>
</div>
</div>
<p>From the Elbow method, we can find the optimal numbers of clustering is 4, and we will use n_clusters=4 for further k-mean clustering.</p>
</section>
<section id="final-results" class="level5">
<h5 class="anchored" data-anchor-id="final-results">Final Results</h5>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bestK <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">4</span>, init<span class="op">=</span><span class="st">'k-means++'</span>,random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>labels4 <span class="op">=</span> bestK.fit_predict(X)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>adv[<span class="st">'nlabels'</span>] <span class="op">=</span> labels4</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'Daily Time Spent on Site'</span>, y<span class="op">=</span><span class="st">"Daily Internet Usage"</span>,hue<span class="op">=</span><span class="st">'nlabels'</span>,data<span class="op">=</span>adv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;AxesSubplot:xlabel='Daily Time Spent on Site', ylabel='Daily Internet Usage'&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="perform-dbscan-and-predict-the-labels" class="level4">
<h4 class="anchored" data-anchor-id="perform-dbscan-and-predict-the-labels">Perform DBSCAN and predict the labels</h4>
<section id="hyperparameter-tunningsilhouette_score" class="level5">
<h5 class="anchored" data-anchor-id="hyperparameter-tunningsilhouette_score">Hyperparameter tunning(silhouette_score)</h5>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform DBSCAN clustering. use the eps and min_samples parameters to find the optimal number of clusters. plot the number of clusters vs the silhouette score. Suggest the optimal number of clusters based on the plot.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>eps_range <span class="op">=</span> np.arange(<span class="fl">0.1</span>,<span class="fl">2.1</span>,<span class="fl">0.1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> eps_range:</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> DBSCAN(eps<span class="op">=</span>i, min_samples<span class="op">=</span><span class="dv">5</span>).fit(X)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> db.labels_</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(np.unique(labels)) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    silhouette_avg <span class="op">=</span> silhouette_score(X, labels)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"For eps = </span><span class="sc">{:0.2f}</span><span class="st">"</span>.<span class="bu">format</span>(i),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"The average silhouette_score is </span><span class="sc">{:0.4f}</span><span class="st">."</span>.<span class="bu">format</span>(silhouette_avg)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>For eps = 0.10 The average silhouette_score is -0.2353.
For eps = 0.20 The average silhouette_score is 0.2678.
For eps = 0.30 The average silhouette_score is 0.1170.
For eps = 0.40 The average silhouette_score is 0.2047.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">11</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> S:</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="fl">0.2</span>, min_samples<span class="op">=</span>s).fit(X)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> db.labels_</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(np.unique(labels)) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    silhouette_avg <span class="op">=</span> silhouette_score(X, labels)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"For min_samples = </span><span class="sc">{:0.2f}</span><span class="st">"</span>.<span class="bu">format</span>(s),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"The average silhouette_score is </span><span class="sc">{:0.4f}</span><span class="st">."</span>.<span class="bu">format</span>(silhouette_avg)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>For min_samples = 1.00 The average silhouette_score is -0.2542.
For min_samples = 2.00 The average silhouette_score is -0.1322.
For min_samples = 3.00 The average silhouette_score is -0.1322.
For min_samples = 4.00 The average silhouette_score is -0.2648.
For min_samples = 5.00 The average silhouette_score is 0.2678.
For min_samples = 6.00 The average silhouette_score is 0.2578.
For min_samples = 7.00 The average silhouette_score is 0.2543.
For min_samples = 8.00 The average silhouette_score is 0.2437.
For min_samples = 9.00 The average silhouette_score is 0.1131.
For min_samples = 10.00 The average silhouette_score is 0.2179.</code></pre>
</div>
</div>
<p>From the silhouette_score, we can get the most suitable eps=0.2, min_samples = 5, I will use thes scores for the final modeling</p>
</section>
<section id="final-results-1" class="level5">
<h5 class="anchored" data-anchor-id="final-results-1">Final results</h5>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="fl">0.2</span>, min_samples<span class="op">=</span><span class="dv">5</span>).fit(X)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>adv[<span class="st">'Labels'</span>] <span class="op">=</span> db.labels_</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(adv[<span class="st">'Daily Time Spent on Site'</span>], adv[<span class="st">'Daily Internet Usage'</span>], hue<span class="op">=</span>adv[<span class="st">'Labels'</span>], </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                palette<span class="op">=</span>sns.color_palette(<span class="st">'hls'</span>, np.unique(db.labels_).shape[<span class="dv">0</span>]))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'DBSCAN with epsilon 0.2, min samples 5'</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/yangyilin/opt/anaconda3/envs/ANLY501/lib/python3.10/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-15-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="agglomerative-clustering" class="level4">
<h4 class="anchored" data-anchor-id="agglomerative-clustering">Agglomerative Clustering</h4>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Agglomerative Clustering</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AgglomerativeClustering().fit(X)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> model.labels_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create linkage for agglomerative clustering, and the dendrogram for the linkage. Suggest the optimal number of clusters based on the dendrogram.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> linkage(X, method<span class="op">=</span><span class="st">'ward'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dend <span class="op">=</span> dendrogram(Z)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">12</span>,color<span class="op">=</span><span class="st">'r'</span>,linestyle<span class="op">=</span><span class="st">'--'</span>,label<span class="op">=</span><span class="dv">21</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>&lt;matplotlib.lines.Line2D at 0x7fea9bca0cd0&gt;</code></pre>
</div>
</div>
<p>From the dendrogram, I will choose the number of clusters as 3 for the the final modeling. As the line shows in the plot, we can see the four clusters are very suitable for clustering.</p>
</section>
<section id="final-results-2" class="level4">
<h4 class="anchored" data-anchor-id="final-results-2">Final results</h4>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>AC <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model and predict clusters</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>yhat_AC <span class="op">=</span> AC.fit_predict(X)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding the Clusters feature to the orignal dataframe.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>adv[<span class="st">"Clusters"</span>]<span class="op">=</span> yhat_AC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(adv[<span class="st">'Daily Time Spent on Site'</span>], adv[<span class="st">'Daily Internet Usage'</span>], hue<span class="op">=</span>adv[<span class="st">'Clusters'</span>], </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                palette<span class="op">=</span>sns.color_palette(<span class="st">'hls'</span>, np.unique(yhat_AC).shape[<span class="dv">0</span>]))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/yangyilin/opt/anaconda3/envs/ANLY501/lib/python3.10/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-19-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="methods-for-instagram-influencer-dataset" class="level3">
<h3 class="anchored" data-anchor-id="methods-for-instagram-influencer-dataset">Methods (for instagram influencer dataset)</h3>
<section id="preprocess-the-dataset" class="level4">
<h4 class="anchored" data-anchor-id="preprocess-the-dataset">Preprocess the dataset</h4>
<p>Input the instagram influencer dataset and drop the nonnumeric column.</p>
<p>More than this, rank, unnamed: 0, influence_score are either labeled columns or unnecessary columns, I dropped these columns as well</p>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../data/00-raw-data/instagram_infl.csv"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.select_dtypes([<span class="st">'number'</span>])</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop([<span class="st">'rank'</span>,<span class="st">'Unnamed: 0'</span>,<span class="st">'influence_score'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>posts(k)</th>
      <th>followers(m)</th>
      <th>X60_day_eng_rate(%)</th>
      <th>new_post_avg_like(m)</th>
      <th>total_likes(b)</th>
      <th>avg_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.30</td>
      <td>475.8</td>
      <td>1.39</td>
      <td>6.5</td>
      <td>29.0</td>
      <td>8700000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.90</td>
      <td>366.2</td>
      <td>1.62</td>
      <td>5.9</td>
      <td>57.4</td>
      <td>8300000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.89</td>
      <td>357.3</td>
      <td>1.24</td>
      <td>4.4</td>
      <td>6.0</td>
      <td>6800000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.80</td>
      <td>342.7</td>
      <td>0.97</td>
      <td>3.3</td>
      <td>11.5</td>
      <td>6200000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.80</td>
      <td>334.1</td>
      <td>0.20</td>
      <td>665.3</td>
      <td>12.5</td>
      <td>1900000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Firstly explore datasets, find whether there are some NA values in the datasets, if yes, drop the NA values.</p>
<p>Then do EDA with datasets, make some visualization plots and first analyze the datasets.</p>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>posts(k)                0
followers(m)            0
X60_day_eng_rate(%)     1
new_post_avg_like(m)    8
total_likes(b)          0
avg_likes               0
dtype: int64</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x7fea8906c610&gt;</code></pre>
</div>
</div>
<section id="seperate-the-dataset-into-features-1" class="level5">
<h5 class="anchored" data-anchor-id="seperate-the-dataset-into-features-1">Seperate the dataset into features</h5>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[[<span class="st">'followers(m)'</span>,<span class="st">'posts(k)'</span>]]<span class="co">#Choose two features for the further clustering</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>scalar <span class="op">=</span> StandardScaler()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>scalar.fit(X)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scalar.transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
</section>
<section id="use-k-mean-clustering-to-process-the-datasets-and-predict-the-model-1" class="level4">
<h4 class="anchored" data-anchor-id="use-k-mean-clustering-to-process-the-datasets-and-predict-the-model-1">Use K-mean Clustering to process the datasets and predict the model</h4>
<section id="hyperparameter-tunning-1" class="level5">
<h5 class="anchored" data-anchor-id="hyperparameter-tunning-1">Hyperparameter tunning</h5>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for k means clustering we will use the elbow method to find the optimal number of clusters. we will use the inertia_ attribute to find the sum of squared distances of samples to their closest cluster center. we will use the range of 1 to 10 clusters. plot the inertia_ values for each number of clusters. make sure to save it in a dataframe and plot it using matplotlib.</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>distortions <span class="op">=</span> []</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>inertias <span class="op">=</span> []</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,k):</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    kmeanModel <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k, init<span class="op">=</span><span class="st">'k-means++'</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    kmeanModel.fit(X)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    distortions.append(<span class="bu">sum</span>(np.<span class="bu">min</span>(cdist(X, kmeanModel.cluster_centers_, <span class="st">'euclidean'</span>),axis<span class="op">=</span><span class="dv">1</span>))<span class="op">/</span>X.shape[<span class="dv">0</span>])</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    inertias.append(kmeanModel.inertia_)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    evaluation <span class="op">=</span> pd.DataFrame.from_records({<span class="st">'Cluster'</span>:np.arange(<span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>), <span class="st">'Distortion'</span>:distortions, <span class="st">"Inertia"</span>:inertias})</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>evaluation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Cluster</th>
      <th>Distortion</th>
      <th>Inertia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1.138777</td>
      <td>384.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.792269</td>
      <td>229.247154</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.549924</td>
      <td>92.641484</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.466145</td>
      <td>73.139519</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.416009</td>
      <td>54.899075</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.388874</td>
      <td>45.679880</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.365474</td>
      <td>37.442178</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.325303</td>
      <td>32.492434</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.306539</td>
      <td>28.839487</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.289259</td>
      <td>24.084946</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yellowbrick.cluster <span class="im">import</span> KElbowVisualizer</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Elbow Method to determine the number of clusters to be formed:'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>Elbow_M <span class="op">=</span> KElbowVisualizer(KMeans(), k<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>Elbow_M.fit(X)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>Elbow_M.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Elbow Method to determine the number of clusters to be formed:</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>&lt;AxesSubplot:title={'center':'Distortion Score Elbow for KMeans Clustering'}, xlabel='k', ylabel='distortion score'&gt;</code></pre>
</div>
</div>
<p>From the Elbow method, we can find the optimal numbers of clustering is 4, and we will use n_clusters=4 for further k-mean clustering.</p>
</section>
<section id="final-results-3" class="level5">
<h5 class="anchored" data-anchor-id="final-results-3">Final Results</h5>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>bestK <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">3</span>, init<span class="op">=</span><span class="st">'k-means++'</span>,random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>labels4 <span class="op">=</span> bestK.fit_predict(X)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'nlabels'</span>] <span class="op">=</span> labels4</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'followers(m)'</span>, y<span class="op">=</span><span class="st">"posts(k)"</span>,hue<span class="op">=</span><span class="st">'nlabels'</span>,data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>&lt;AxesSubplot:xlabel='followers(m)', ylabel='posts(k)'&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="perform-dbscan-and-predict-the-labels-1" class="level4">
<h4 class="anchored" data-anchor-id="perform-dbscan-and-predict-the-labels-1">Perform DBSCAN and predict the labels</h4>
<section id="hyperparameter-tunningsilhouette_score-1" class="level5">
<h5 class="anchored" data-anchor-id="hyperparameter-tunningsilhouette_score-1">Hyperparameter tunning(silhouette_score)</h5>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform DBSCAN clustering. use the eps and min_samples parameters to find the optimal number of clusters. plot the number of clusters vs the silhouette score. Suggest the optimal number of clusters based on the plot.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>eps_range <span class="op">=</span> np.arange(<span class="fl">0.1</span>,<span class="fl">2.1</span>,<span class="fl">0.1</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> eps_range:</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> DBSCAN(eps<span class="op">=</span>i, min_samples<span class="op">=</span><span class="dv">5</span>).fit(X)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> db.labels_</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(np.unique(labels)) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    silhouette_avg <span class="op">=</span> silhouette_score(X, labels)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"For eps = </span><span class="sc">{:0.2f}</span><span class="st">"</span>.<span class="bu">format</span>(i),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"The average silhouette_score is </span><span class="sc">{:0.4f}</span><span class="st">."</span>.<span class="bu">format</span>(silhouette_avg)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>For eps = 0.10 The average silhouette_score is 0.0935.
For eps = 0.20 The average silhouette_score is 0.5144.
For eps = 0.30 The average silhouette_score is 0.5344.
For eps = 0.40 The average silhouette_score is 0.5487.
For eps = 0.50 The average silhouette_score is 0.5568.
For eps = 0.60 The average silhouette_score is 0.5653.
For eps = 0.70 The average silhouette_score is 0.6206.
For eps = 0.80 The average silhouette_score is 0.6351.
For eps = 0.90 The average silhouette_score is 0.5903.
For eps = 1.00 The average silhouette_score is 0.6169.
For eps = 1.10 The average silhouette_score is 0.6431.
For eps = 1.20 The average silhouette_score is 0.6576.
For eps = 1.30 The average silhouette_score is 0.6838.
For eps = 1.40 The average silhouette_score is 0.6838.
For eps = 1.50 The average silhouette_score is 0.6838.
For eps = 1.60 The average silhouette_score is 0.6838.
For eps = 1.70 The average silhouette_score is 0.6838.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">11</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> S:</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="fl">1.4</span>, min_samples<span class="op">=</span>s).fit(X)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> db.labels_</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(np.unique(labels)) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    silhouette_avg <span class="op">=</span> silhouette_score(X, labels)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"For min_samples = </span><span class="sc">{:0.2f}</span><span class="st">"</span>.<span class="bu">format</span>(s),</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"The average silhouette_score is </span><span class="sc">{:0.4f}</span><span class="st">."</span>.<span class="bu">format</span>(silhouette_avg)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>For min_samples = 1.00 The average silhouette_score is 0.6838.
For min_samples = 2.00 The average silhouette_score is 0.6838.
For min_samples = 3.00 The average silhouette_score is 0.6838.
For min_samples = 4.00 The average silhouette_score is 0.6838.
For min_samples = 5.00 The average silhouette_score is 0.6838.
For min_samples = 6.00 The average silhouette_score is 0.6838.
For min_samples = 7.00 The average silhouette_score is 0.6838.
For min_samples = 8.00 The average silhouette_score is 0.6838.
For min_samples = 9.00 The average silhouette_score is 0.6838.
For min_samples = 10.00 The average silhouette_score is 0.6530.</code></pre>
</div>
</div>
<p>From the silhouette_score, we can get the most suitable eps=0.7, min_samples = 3, I will use thes scores for the final modeling</p>
</section>
<section id="final-results-4" class="level5">
<h5 class="anchored" data-anchor-id="final-results-4">Final Results</h5>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="fl">1.4</span>, min_samples<span class="op">=</span><span class="dv">5</span>).fit(X)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Labels'</span>] <span class="op">=</span> db.labels_</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>df[<span class="st">'followers(m)'</span>], y<span class="op">=</span>df[<span class="st">"posts(k)"</span>], hue<span class="op">=</span>df[<span class="st">'Labels'</span>])</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'DBSCAN with epsilon 0.7, min samples 4'</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="perform-agglomerative-clustering" class="level4">
<h4 class="anchored" data-anchor-id="perform-agglomerative-clustering">Perform Agglomerative Clustering</h4>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Agglomerative Clustering</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AgglomerativeClustering().fit(X)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> model.labels_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create linkage for agglomerative clustering, and the dendrogram for the linkage. Suggest the optimal number of clusters based on the dendrogram.</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> linkage(X, method<span class="op">=</span><span class="st">'ward'</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>dend <span class="op">=</span> dendrogram(Z)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">8</span>,color<span class="op">=</span><span class="st">'r'</span>,linestyle<span class="op">=</span><span class="st">'--'</span>,label<span class="op">=</span><span class="dv">21</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>&lt;matplotlib.lines.Line2D at 0x7feabc56b2b0&gt;</code></pre>
</div>
</div>
<p>From the dendrogram, I will choose the number of clusters as 3 for the the final modeling. As the line shows in the plot, we can see the four clusters are very suitable for clustering.</p>
</section>
<section id="final-results-5" class="level4">
<h4 class="anchored" data-anchor-id="final-results-5">Final Results</h4>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>AC <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model and predict clusters</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>yhat_AC <span class="op">=</span> AC.fit_predict(X)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding the Clusters feature to the orignal dataframe.</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Clusters"</span>]<span class="op">=</span> yhat_AC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="37">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>df[<span class="st">'followers(m)'</span>], y<span class="op">=</span>df[<span class="st">"posts(k)"</span>], hue<span class="op">=</span>df[<span class="st">'Clusters'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>&lt;AxesSubplot:xlabel='followers(m)', ylabel='posts(k)'&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<section id="final-results-for-advertisment-datasets" class="level4">
<h4 class="anchored" data-anchor-id="final-results-for-advertisment-datasets">Final results for advertisment datasets</h4>
<p>For this section, I will use EDA to take a close glimpse about different methods used in datasets and get the results.</p>
<section id="k-means-1" class="level5">
<h5 class="anchored" data-anchor-id="k-means-1">K-means</h5>
<div class="cell" data-execution_count="38">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>pl <span class="op">=</span> sns.countplot(x<span class="op">=</span>adv[<span class="st">"nlabels"</span>])</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>pl.set_title(<span class="st">"Distribution Of The Clusters(K-means)"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The clusters are seemed to be fairly distributed.</p>
<div class="cell" data-execution_count="39">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'Daily Time Spent on Site'</span>, y<span class="op">=</span><span class="st">"Daily Internet Usage"</span>,hue<span class="op">=</span><span class="st">'nlabels'</span>,data<span class="op">=</span>adv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>&lt;AxesSubplot:xlabel='Daily Time Spent on Site', ylabel='Daily Internet Usage'&gt;</code></pre>
</div>
</div>
<p>In the plot, we can divide the clustering into four groups:</p>
<p>group0: High Daily Spent on Site &amp; Average Daily Internet Usage</p>
<p>group1: Average Daily Spent on Site &amp; Low Daily Internet Usage</p>
<p>group2: High Daily Spent on Site &amp; High Daily Internet Usage</p>
<p>group3: Low Daily Spent on Site &amp; Average Daily Internet Usage</p>
<p>Then I will train these four groups on the columns clicked on ad in order to determine what kind of group is most likely to click on advertisements.</p>
<div class="cell" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>pl<span class="op">=</span>sns.countplot(hue<span class="op">=</span>adv[<span class="st">"nlabels"</span>], x<span class="op">=</span>adv[<span class="st">"Clicked on Ad"</span>])</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-37-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-37-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As we can see in the plot, the internet users who in group two(High Daily Spent on Site &amp; High Daily Internet Usage) are more likely to decide not to click on the advertisements. On the contrary, the internet users who in group three(Low Daily Spent on Site &amp; Average Daily Internet Usage) are more likely to decide to click on the advertisements.</p>
<p>In this dataset, K-mean show great performances for clustering, the users can also change the feature columns in order to cluster different kinds of groups in order to gather different results.</p>
</section>
</section>
<section id="dbscan" class="level4">
<h4 class="anchored" data-anchor-id="dbscan">DBSCAN</h4>
<div class="cell" data-execution_count="41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>DS <span class="op">=</span> sns.countplot(x<span class="op">=</span>adv[<span class="st">"Labels"</span>])</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>DS.set_title(<span class="st">"Distribution Of The Clusters(DBSCAN)"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-38-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="42">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(adv[<span class="st">'Daily Time Spent on Site'</span>], adv[<span class="st">'Daily Internet Usage'</span>], hue<span class="op">=</span>adv[<span class="st">'Labels'</span>], </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                palette<span class="op">=</span>sns.color_palette(<span class="st">'hls'</span>, np.unique(adv[<span class="st">'Labels'</span>]).shape[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/yangyilin/opt/anaconda3/envs/ANLY501/lib/python3.10/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>&lt;AxesSubplot:xlabel='Daily Time Spent on Site', ylabel='Daily Internet Usage'&gt;</code></pre>
</div>
</div>
<p>From DBSCAN clustering, we can clearly see that the different groups of clustering are not fairly distributed. We can conclude that DBSCAN is not a good method for evaluating the advertiment dataset. Because DBSCAN cannot easily handle data points with similar density. We can see there are a lot of outliers in the plots and cannot beeasily separated together.</p>
</section>
<section id="agglomerative-clustering-1" class="level4">
<h4 class="anchored" data-anchor-id="agglomerative-clustering-1">Agglomerative Clustering</h4>
<div class="cell" data-execution_count="43">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>agg <span class="op">=</span> sns.countplot(x<span class="op">=</span>adv[<span class="st">"Clusters"</span>])</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>agg.set_title(<span class="st">"Distribution Of The Clusters(Agglomerative Clustering)"</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The Group 2 are obviously less than other two groups.</p>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(adv[<span class="st">'Daily Time Spent on Site'</span>], adv[<span class="st">'Daily Internet Usage'</span>], hue<span class="op">=</span>adv[<span class="st">'Clusters'</span>], </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                palette<span class="op">=</span>sns.color_palette(<span class="st">'hls'</span>, np.unique(adv[<span class="st">'Clusters'</span>]).shape[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/yangyilin/opt/anaconda3/envs/ANLY501/lib/python3.10/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>&lt;AxesSubplot:xlabel='Daily Time Spent on Site', ylabel='Daily Internet Usage'&gt;</code></pre>
</div>
</div>
<p>In the plot, we can divide the clustering into three groups:</p>
<p>group0: Low Daily Spent on Site &amp; Low Daily Internet Usage</p>
<p>group1: High Daily Spent on Site &amp; Low Daily Internet Usage</p>
<p>group2: High Daily Spent on Site &amp; High Daily Internet Usage</p>
<p>Then I will train these three groups on the columns clicked on ad in order to determine what kind of group is most likely to click on advertisements.</p>
<div class="cell" data-execution_count="45">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>pl<span class="op">=</span>sns.countplot(hue<span class="op">=</span>adv[<span class="st">"Clusters"</span>], x<span class="op">=</span>adv[<span class="st">"Clicked on Ad"</span>])</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-42-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As we can see in the plot, the internet users who in group one(High Daily Spent on Site &amp; Low Daily Internet Usage) are more likely to decide not to click on the advertisements. On the contrary, the internet users who in group zero(Low Daily Spent on Site &amp; Low Daily Internet Usage) are more likely to decide to click on the advertisements. The agglomerative clustering indicates similar conclusions as K-mean clustering. We can combine these two kinds of results together to gather the final conclusion.</p>
<p>In this dataset, agglomerative clustering show good performances for clustering, but because the group is not fairly distributed, the result need to be further evaluated by other methods. The users can also change the feature columns in order to cluster different kinds of groups in order to gather different results.</p>
<div class="cell" data-execution_count="46">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pl <span class="op">=</span> sns.countplot(x<span class="op">=</span>df[<span class="st">"nlabels"</span>])</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>pl.set_title(<span class="st">"Distribution Of The Clusters(K-means)"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>As we can see, the distribution of K-means clustering are not fairly distributed. The group one is highly larger than other groups.</p>
<div class="cell" data-execution_count="47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'followers(m)'</span>, y<span class="op">=</span><span class="st">"posts(k)"</span>,hue<span class="op">=</span><span class="st">'nlabels'</span>,data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>&lt;AxesSubplot:xlabel='followers(m)', ylabel='posts(k)'&gt;</code></pre>
</div>
</div>
<p>In the plot, we can divide the clustering into three groups:</p>
<p>group0: Low followers &amp; High number of posts</p>
<p>group1: Low followers &amp; Low number of posts</p>
<p>group2: High followers &amp; Low number of posts</p>
<section id="dbscan-1" class="level5">
<h5 class="anchored" data-anchor-id="dbscan-1">DBSCAN</h5>
<div class="cell" data-execution_count="48">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>DS <span class="op">=</span> sns.countplot(x<span class="op">=</span>df[<span class="st">"Labels"</span>])</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>DS.set_title(<span class="st">"Distribution Of The Clusters(DBSCAN)"</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-45-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The DBSCAN cannot be used in these plots, because the data points in this dataset is extremely similar with each other, it is hard for DBSCAN to cluster data points.</p>
</section>
<section id="agglomerative-clustering-2" class="level5">
<h5 class="anchored" data-anchor-id="agglomerative-clustering-2">Agglomerative Clustering</h5>
<div class="cell" data-execution_count="49">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>agg <span class="op">=</span> sns.countplot(x<span class="op">=</span>df[<span class="st">"Clusters"</span>])</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>agg.set_title(<span class="st">"Distribution Of The Clusters(Agglomerative Clustering)"</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-46-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>As we can see, the distribution of Agglomerative clustering are not fairly distributed. The group 0 is highly larger than other groups.</p>
<div class="cell" data-execution_count="50">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>df[<span class="st">'followers(m)'</span>], y<span class="op">=</span>df[<span class="st">"posts(k)"</span>], hue<span class="op">=</span>df[<span class="st">'Clusters'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>&lt;AxesSubplot:xlabel='followers(m)', ylabel='posts(k)'&gt;</code></pre>
</div>
</div>
<p>In the plot, we can divide the clustering into three groups:</p>
<p>group0: Low followers &amp; Low number of posts</p>
<p>group1: Average followers &amp; Low number of posts</p>
<p>group2: High followers &amp; Low number of posts</p>
<p>group3: Low followers &amp; High number of posts</p>
<p>As we can see in this dataset, the three models cannot evaluate well because through this dataset, the points are highly similar with each other with few outliers. So clustering may be difficult to clearly seperate one group to another group. From my hypothesis, since the dataset of the instagram influencers are already popular enough, so they have similar followers and number of posts. It is hard for different methods to be implemented in this dataset. But the K-mean and Agglomerative Clustering can also be generated to evaluate other factors to gather some results.</p>
</section>
</section>
</section>
<section id="conclusions" class="level3">
<h3 class="anchored" data-anchor-id="conclusions">Conclusions</h3>
<p>Clustering is a very useful tool for data analytics. For our project, it can seperate unsupervied dataset into different groups in order to help us know the relationship between each group and difference results generated in different groups. In the real life, this typ of clustering implement is called customer segmentation. For example, we can generate customers’ different behaviors and divide them into different groups in order to match the targeted marketing compaigns. For out project topic, product sellers can first generate customer behaviors and then target suitable internet influencers to help them to do the advertisments promotion in order to earn more benefits.</p>
<p>More than this, From this analysis, we can clearly see that the development of social media platforms and wemedia influencers cannot live alone without data analytics and machine learnings. Clustering and Classification are all very useful tool for them to locate the target audiences and help them to earn more benefits.</p>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<p>Girgin, S. (2021, December 10). K-Means Clustering Model in 6 Steps with Python - PursuitData. Medium. https://medium.com/pursuitnotes/k-means-clustering-model-in-6-steps-with-python-35b532cfa8ad</p>
<p>GeeksforGeeks. (2022, August 23). Clustering in Machine Learning. https://www.geeksforgeeks.org/clustering-in-machine-learning/</p>
<p>Subramanian, N. B. (2021, June 27). Hierarchical Clustering. AI ASPIRANT. https://aiaspirant.com/hierarchical-clustering/</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>